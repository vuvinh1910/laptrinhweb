<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test QR VietQR</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="stylesheet" th:href="@{/css/user/payment.css}">
    <link rel="stylesheet" th:href="@{/css/public/header-navbar.css}">
    <script th:src="@{/js/pay-voucher.js}" defer></script>
</head>
<body>
<div th:replace="public/header-navbar :: navbar"></div>
<div class="payment-container"
     th:data-price="${price}"
     th:data-booking-id="${bookingId}"
     th:data-voucher-code="${voucherCode}">
    <a th:href="@{/users/cart}" class="back-button"><i class="fas fa-arrow-left"></i> Quay lại</a>
    <h1>Thanh Toán Phòng</h1>
    <div th:if="${success}" class="alert alert-success" th:text="${success}"></div>
    <div th:if="${error}" class="alert alert-danger" th:text="${error}"></div>
    <form id="payment-form" th:action="@{/users/booking-rooms/{id}/payment(id=${bookingId})}" method="post" style="display: none;">
        <input type="hidden" name="voucherCode" id="hiddenVoucherCode">
    </form>
    <!-- Các icon thanh toán tự động từ Font Awesome -->
    <div class="payment-icons">
        <i class="fab fa-cc-visa payment-icon"></i>
        <i class="fab fa-cc-mastercard payment-icon"></i>
        <i class="fab fa-cc-paypal payment-icon"></i>
    </div>

    <p>Quét mã QR dưới đây để thực hiện chuyển khoản.</p>
    <img id="vietqr-image" src="" alt="Mã QR VietQR" class="img-fluid"
         style="max-width: 367px; margin-bottom: 20px;">
    <div id="payment-status" class="mt-3 text-primary">Đang chờ thanh toán...</div>
    <!-- Form áp dụng voucher -->
    <form th:action="@{/users/booking-rooms/{id}/applyVoucher(id=${bookingId})}" method="post" class="mt-3">
        <div class="input-group mb-3">
            <input type="text" name="voucherCode" id="voucherCode" class="form-control" placeholder="Nhập mã voucher nếu có"
                   th:value="${voucherCode}">
            <button type="submit" class="btn btn-primary">Áp dụng</button>
        </div>
    </form>

    <h4>Tổng tiền: <span th:text="${price} + ' VND'">0 VND</span></h4>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>